import{i as e,n as t,o as n,r,s as i,t as a}from"./zod-CHCjAJAU.js";import{t as o}from"./useServerFn-DsTzOVMO.js";import{E as s,M as c,O as l,S as u,b as d,c as f,n as p,r as m,x as h}from"./main-nBXvAf8O.js";import"./loader-circle-ay3JJMrH.js";import{t as g}from"./circle-alert-DFvHrm34.js";import{n as _,r as v,t as y}from"./alert-C9E30bFM.js";var b=c(l()),x=c(s()),S=p({password:m().min(8,`Password must be at least 8 characters`),confirmPassword:m().min(8,`Password must be at least 8 characters`)}).refine(e=>e.password===e.confirmPassword,{message:`Passwords don't match`,path:[`confirmPassword`]});function C(){let s=u({from:`/_auth/reset-password`}),c=h(),[l,p]=(0,b.useState)(!1),m=o(f),C=e({resolver:a(S),defaultValues:{password:``,confirmPassword:``}}),w=i({mutationFn:async e=>{if(!s.userId||!s.secret)throw Error(`Invalid recovery link`);await m({data:{userId:s.userId,secret:s.secret,password:e.password,confirmPassword:e.confirmPassword}})},onSuccess:()=>{p(!0),C.reset(),setTimeout(()=>{c({to:`/sign-in`})},3e3)},onError:e=>{console.error(`Reset password error:`,e),C.setError(`root`,{message:e.message||`Failed to reset password`})}});return!s.userId||!s.secret?(0,x.jsxs)(n,{title:`Invalid recovery link`,description:`The password recovery link is invalid or has expired`,children:[(0,x.jsxs)(y,{className:`border-red-500 bg-red-50 dark:bg-red-950`,children:[(0,x.jsx)(g,{className:`h-4 w-4 text-red-600 dark:text-red-400`}),(0,x.jsx)(_,{className:`text-red-800 dark:text-red-200`,children:`This recovery link is invalid or has expired. Please request a new password recovery link.`})]}),(0,x.jsx)(`div`,{className:`text-center text-sm text-muted-foreground mt-4 space-x-1`,children:(0,x.jsx)(`div`,{className:`inline-block`,children:(0,x.jsx)(d,{to:`/forgot-password`,className:`font-medium text-primary underline-offset-4 hover:underline`,children:`Request new recovery link`})})})]}):l?(0,x.jsxs)(n,{title:`Password reset successful`,description:`Your password has been updated`,children:[(0,x.jsxs)(y,{className:`border-green-500 bg-green-50 dark:bg-green-950`,children:[(0,x.jsx)(v,{className:`h-4 w-4 text-green-600 dark:text-green-400`}),(0,x.jsx)(_,{className:`text-green-800 dark:text-green-200`,children:`Your password has been reset successfully. You'll be redirected to the sign in page shortly.`})]}),(0,x.jsx)(`div`,{className:`text-center text-sm text-muted-foreground mt-4 space-x-1`,children:(0,x.jsx)(`div`,{className:`inline-block`,children:(0,x.jsx)(d,{to:`/sign-in`,className:`font-medium text-primary underline-offset-4 hover:underline`,children:`Sign in now`})})})]}):(0,x.jsxs)(n,{title:`Reset password`,description:`Enter your new password below`,children:[(0,x.jsx)(r,{schema:S,defaultValues:{password:``,confirmPassword:``},onSubmit:e=>w.mutate(e),submitText:`Reset password`,loadingText:`Resetting...`,isLoading:w.isPending,form:C,children:e=>(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(t,{control:e.control,name:`password`,label:`New Password`,placeholder:`Enter your new password`,type:`password`}),(0,x.jsx)(t,{control:e.control,name:`confirmPassword`,label:`Confirm Password`,placeholder:`Confirm your new password`,type:`password`})]})}),(0,x.jsxs)(`div`,{className:`text-center text-sm text-muted-foreground mt-4 space-x-1`,children:[(0,x.jsx)(`div`,{className:`inline-block`,children:`Remember your password? `}),(0,x.jsx)(`div`,{className:`inline-block`,children:(0,x.jsx)(d,{to:`/sign-in`,className:`font-medium text-primary underline-offset-4 hover:underline`,children:`Sign in`})})]})]})}export{C as component};
//# sourceMappingURL=reset-password-DfLKSAfR.js.map