{"version":3,"file":"sign-up-D7R0OnaA.js","names":["useMutation","Link","useNavigate","useRouter","useSearch","z","AuthCard","AuthForm","AuthField","signUpFn","useServerFn","useForm","zodResolver","Route","signUpSchema","object","email","string","password","min","SignUpPage","search","from","id","navigate","router","signUp","form","resolver","defaultValues","signUpMutation","mutationFn","data","infer","redirect","onSuccess","invalidate","to","onError","error","status","message","includes","console","setError","mutate","isPending","control","undefined","component"],"sources":["../../../src/routes/_auth/sign-up.tsx?tsr-split=component"],"sourcesContent":["/**\n * @imagine-readonly\n */\n\nimport { useMutation } from '@tanstack/react-query'\nimport {\n  createFileRoute,\n  Link,\n  useNavigate,\n  useRouter,\n  useSearch,\n} from '@tanstack/react-router'\nimport { z } from 'zod'\nimport { AuthCard } from '@/components/auth/auth-card'\nimport { AuthForm } from '@/components/auth/auth-form'\nimport { AuthField } from '@/components/auth/auth-field'\nimport { signUpFn } from '@/server/functions/auth'\nimport { useServerFn } from '@tanstack/react-start'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\n\nconst searchSchema = z.object({\n  redirect: z.string().optional(),\n})\n\nexport const Route = createFileRoute('/_auth/sign-up')({\n  component: SignUpPage,\n  validateSearch: searchSchema,\n})\n\nconst signUpSchema = z.object({\n  email: z.string().email('Please enter a valid email address'),\n  password: z.string().min(8, 'Password must be at least 8 characters'),\n})\n\nfunction SignUpPage() {\n  const search = useSearch({ from: Route.id })\n  const navigate = useNavigate()\n  const router = useRouter()\n  const signUp = useServerFn(signUpFn)\n  const form = useForm({\n    resolver: zodResolver(signUpSchema),\n    defaultValues: {\n      email: '',\n      password: '',\n    },\n  })\n\n  const signUpMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof signUpSchema>) => {\n      await signUp({\n        data: { ...data, redirect: search.redirect },\n      })\n    },\n    onSuccess: async () => {\n      // Invalidate router to refresh auth state\n      await router.invalidate()\n      // Navigate to the redirect destination if provided\n      if (search.redirect) {\n        await navigate({ to: search.redirect })\n      }\n    },\n\n    onError: async (error: {\n      status: number\n      redirect: boolean\n      message: string\n    }) => {\n      // Check if it's a redirect error (TanStack Start throws redirects as errors)\n      if (\n        error?.status === 302 ||\n        error?.redirect ||\n        error?.message?.includes('redirect')\n      ) {\n        // Invalidate router to refresh auth state\n        await router.invalidate()\n        // Navigate to the redirect destination if provided\n        if (search.redirect) {\n          await navigate({ to: search.redirect })\n        }\n        return\n      }\n      console.error('Sign up error:', error)\n      form.setError('root', { message: error.message || 'Failed to sign up' })\n    },\n  })\n\n  return (\n    <AuthCard\n      title=\"Sign up\"\n      description=\"Enter your details to create a new account\"\n    >\n      <AuthForm\n        schema={signUpSchema}\n        defaultValues={{\n          email: '',\n          password: '',\n        }}\n        onSubmit={(data) => signUpMutation.mutate(data)}\n        submitText=\"Sign up\"\n        loadingText=\"Signing up...\"\n        isLoading={signUpMutation.isPending}\n        form={form}\n      >\n        {(form) => (\n          <>\n            <AuthField\n              control={form.control}\n              name=\"email\"\n              label=\"Email\"\n              placeholder=\"john@doe.com\"\n              type=\"email\"\n            />\n\n            <AuthField\n              control={form.control}\n              name=\"password\"\n              label=\"Password\"\n              placeholder=\"Enter your password\"\n              type=\"password\"\n            />\n          </>\n        )}\n      </AuthForm>\n\n      <div className=\"text-center text-sm text-muted-foreground mt-4 space-x-1\">\n        <div className=\"inline-block\">Already have an account? </div>\n        <div className=\"inline-block\">\n          <Link\n            to=\"/sign-in\"\n            search={search.redirect ? { redirect: search.redirect } : undefined}\n            className=\"font-medium text-primary underline-offset-4 hover:underline\"\n          >\n            Sign in\n          </Link>\n        </div>\n      </div>\n    </AuthCard>\n  )\n}\n"],"mappings":"oQA8BMc,EAAeT,EAAS,CAC5BW,MAAOX,GAAU,CAACW,MAAM,qCAAqC,CAC7DE,SAAUb,GAAU,CAACc,IAAI,EAAG,yCAAwC,CACrE,CAAC,CAEF,SAASC,GAAa,CACpB,IAAMC,EAASjB,EAAU,CAAEkB,KAAMT,EAAMU,GAAI,CAAC,CACtCC,EAAWtB,GAAa,CACxBuB,EAAStB,GAAW,CACpBuB,EAAShB,EAAYD,EAAS,CAC9BkB,EAAOhB,EAAQ,CACnBiB,SAAUhB,EAAYE,EAAa,CACnCe,cAAe,CACbb,MAAO,GACPE,SAAU,GACZ,CACD,CAAC,CAEIY,EAAiB9B,EAAY,CACjC+B,WAAY,KAAOC,IAAuC,CACxD,MAAMN,EAAO,CACXM,KAAM,CAAE,GAAGA,EAAME,SAAUb,EAAOa,SAAS,CAC5C,CAAC,EAEJC,UAAW,SAAY,CAErB,MAAMV,EAAOW,YAAY,CAErBf,EAAOa,UACT,MAAMV,EAAS,CAAEa,GAAIhB,EAAOa,SAAU,CAAC,EAI3CI,QAAS,KAAOC,IAIV,CAEJ,GACEA,GAAOC,SAAW,KAClBD,GAAOL,UACPK,GAAOE,SAASC,SAAS,WAAW,CACpC,CAEA,MAAMjB,EAAOW,YAAY,CAErBf,EAAOa,UACT,MAAMV,EAAS,CAAEa,GAAIhB,EAAOa,SAAU,CAAC,CAEzC,OAEFS,QAAQJ,MAAM,iBAAkBA,EAAM,CACtCZ,EAAKiB,SAAS,OAAQ,CAAEH,QAASF,EAAME,SAAW,oBAAqB,CAAC,EAE3E,CAAC,CAEF,OACE,EAAA,EAAA,MAAC,EAAA,CACC,MAAM,UACN,YAAY,wDAEZ,EAAA,EAAA,KAAC,EAAA,CACC,OAAQ3B,EACR,cAAe,CACbE,MAAO,GACPE,SAAU,GACX,CACD,SAAWc,GAASF,EAAee,OAAOb,EAAK,CAC/C,WAAW,UACX,YAAY,gBACZ,UAAWF,EAAegB,UACpBnB,gBAEJA,IACA,EAAA,EAAA,MAAA,EAAA,SAAA,CAAA,SAAA,EACE,EAAA,EAAA,KAAC,EAAA,CACC,QAASA,EAAKoB,QACd,KAAK,QACL,MAAM,QACN,YAAY,eACZ,KAAK,SAAO,EAGd,EAAA,EAAA,KAAC,EAAA,CACC,QAASpB,EAAKoB,QACd,KAAK,WACL,MAAM,WACN,YAAY,sBACZ,KAAK,YAAU,CAAA,CAAA,CAGpB,EACO,EAEV,EAAA,EAAA,MAAC,MAAA,CAAI,UAAU,sEACb,EAAA,EAAA,KAAC,MAAA,CAAI,UAAU,wBAAe,6BAA8B,EAC5D,EAAA,EAAA,KAAC,MAAA,CAAI,UAAU,yBACb,EAAA,EAAA,KAAC,EAAA,CACC,GAAG,WACH,OAAQ1B,EAAOa,SAAW,CAAEA,SAAUb,EAAOa,SAAU,CAAGc,IAAAA,GAC1D,UAAU,uEAA6D,WAGnE,EACH,CAAA,EACF,CAAA,EACI"}