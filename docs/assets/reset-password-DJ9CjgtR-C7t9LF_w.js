import{j as e}from"./QueryClientProvider-DQQzmD6f.js";import"./useMatch-FRFXwByw.js";import{n as t,t as n}from"./useNavigate-oTHx4_IR.js";import{A as r,P as i,_ as a}from"./index-BM_RBz7Q.js";import"./dist-ujpPmBYa.js";import{t as o}from"./circle-alert-BBAwyMZu.js";import{n as s,r as c,t as l}from"./alert-BdYX3X60-B4-9AXIc.js";import{n as u,r as d}from"./zod-DsoXa-XD.js";import{t as f}from"./useServerFn-D_M3mnTc-xMIRQCHR.js";import{i as p}from"./auth-Dh9yZB3l-B0ENX6BS.js";import{a as m,i as h,n as g,o as _,r as v,t as y}from"./zod-CqBg_A8e.js";var b=i(r()),x=i(a()),S=u({password:d().min(8,`Password must be at least 8 characters`),confirmPassword:d().min(8,`Password must be at least 8 characters`)}).refine(e=>e.password===e.confirmPassword,{message:`Passwords don't match`,path:[`confirmPassword`]});function C(){let r=t({from:`/_auth/reset-password`}),i=n(),[a,u]=(0,x.useState)(!1),d=f(p),C=_({resolver:y(S),defaultValues:{password:``,confirmPassword:``}}),w=g({mutationFn:async e=>{if(!r.userId||!r.secret)throw Error(`Invalid recovery link`);await d({data:{userId:r.userId,secret:r.secret,password:e.password,confirmPassword:e.confirmPassword}})},onSuccess:()=>{u(!0),C.reset(),setTimeout(()=>{i({to:`/sign-in`})},3e3)},onError:e=>{console.error(`Reset password error:`,e),C.setError(`root`,{message:e.message||`Failed to reset password`})}});return!r.userId||!r.secret?(0,b.jsxs)(v,{title:`Invalid recovery link`,description:`The password recovery link is invalid or has expired`,children:[(0,b.jsxs)(l,{className:`border-red-500 bg-red-50 dark:bg-red-950`,children:[(0,b.jsx)(o,{className:`h-4 w-4 text-red-600 dark:text-red-400`}),(0,b.jsx)(s,{className:`text-red-800 dark:text-red-200`,children:`This recovery link is invalid or has expired. Please request a new password recovery link.`})]}),(0,b.jsx)(`div`,{className:`text-center text-sm text-muted-foreground mt-4 space-x-1`,children:(0,b.jsx)(`div`,{className:`inline-block`,children:(0,b.jsx)(e,{to:`/forgot-password`,className:`font-medium text-primary underline-offset-4 hover:underline`,children:`Request new recovery link`})})})]}):a?(0,b.jsxs)(v,{title:`Password reset successful`,description:`Your password has been updated`,children:[(0,b.jsxs)(l,{className:`border-green-500 bg-green-50 dark:bg-green-950`,children:[(0,b.jsx)(c,{className:`h-4 w-4 text-green-600 dark:text-green-400`}),(0,b.jsx)(s,{className:`text-green-800 dark:text-green-200`,children:`Your password has been reset successfully. You'll be redirected to the sign in page shortly.`})]}),(0,b.jsx)(`div`,{className:`text-center text-sm text-muted-foreground mt-4 space-x-1`,children:(0,b.jsx)(`div`,{className:`inline-block`,children:(0,b.jsx)(e,{to:`/sign-in`,className:`font-medium text-primary underline-offset-4 hover:underline`,children:`Sign in now`})})})]}):(0,b.jsxs)(v,{title:`Reset password`,description:`Enter your new password below`,children:[(0,b.jsx)(m,{schema:S,defaultValues:{password:``,confirmPassword:``},onSubmit:e=>w.mutate(e),submitText:`Reset password`,loadingText:`Resetting...`,isLoading:w.isPending,form:C,children:e=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h,{control:e.control,name:`password`,label:`New Password`,placeholder:`Enter your new password`,type:`password`}),(0,b.jsx)(h,{control:e.control,name:`confirmPassword`,label:`Confirm Password`,placeholder:`Confirm your new password`,type:`password`})]})}),(0,b.jsxs)(`div`,{className:`text-center text-sm text-muted-foreground mt-4 space-x-1`,children:[(0,b.jsx)(`div`,{className:`inline-block`,children:`Remember your password? `}),(0,b.jsx)(`div`,{className:`inline-block`,children:(0,b.jsx)(e,{to:`/sign-in`,className:`font-medium text-primary underline-offset-4 hover:underline`,children:`Sign in`})})]})]})}export{C as component};