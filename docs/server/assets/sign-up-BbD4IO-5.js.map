{"version":3,"file":"sign-up-BbD4IO-5.js","names":["useMutation","Link","useNavigate","useRouter","useSearch","z","AuthCard","AuthForm","AuthField","signUpFn","useServerFn","useForm","zodResolver","Route","signUpSchema","object","email","string","password","min","SignUpPage","search","from","id","navigate","router","signUp","form","resolver","defaultValues","signUpMutation","mutationFn","data","infer","redirect","onSuccess","invalidate","to","onError","error","status","message","includes","console","setError","mutate","isPending","control","undefined","component"],"sources":["../../../src/routes/_auth/sign-up.tsx?tsr-split=component"],"sourcesContent":["/**\n * @imagine-readonly\n */\n\nimport { useMutation } from '@tanstack/react-query'\nimport {\n  createFileRoute,\n  Link,\n  useNavigate,\n  useRouter,\n  useSearch,\n} from '@tanstack/react-router'\nimport { z } from 'zod'\nimport { AuthCard } from '@/components/auth/auth-card'\nimport { AuthForm } from '@/components/auth/auth-form'\nimport { AuthField } from '@/components/auth/auth-field'\nimport { signUpFn } from '@/server/functions/auth'\nimport { useServerFn } from '@tanstack/react-start'\nimport { useForm } from 'react-hook-form'\nimport { zodResolver } from '@hookform/resolvers/zod'\n\nconst searchSchema = z.object({\n  redirect: z.string().optional(),\n})\n\nexport const Route = createFileRoute('/_auth/sign-up')({\n  component: SignUpPage,\n  validateSearch: searchSchema,\n})\n\nconst signUpSchema = z.object({\n  email: z.string().email('Please enter a valid email address'),\n  password: z.string().min(8, 'Password must be at least 8 characters'),\n})\n\nfunction SignUpPage() {\n  const search = useSearch({ from: Route.id })\n  const navigate = useNavigate()\n  const router = useRouter()\n  const signUp = useServerFn(signUpFn)\n  const form = useForm({\n    resolver: zodResolver(signUpSchema),\n    defaultValues: {\n      email: '',\n      password: '',\n    },\n  })\n\n  const signUpMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof signUpSchema>) => {\n      await signUp({\n        data: { ...data, redirect: search.redirect },\n      })\n    },\n    onSuccess: async () => {\n      // Invalidate router to refresh auth state\n      await router.invalidate()\n      // Navigate to the redirect destination if provided\n      if (search.redirect) {\n        await navigate({ to: search.redirect })\n      }\n    },\n\n    onError: async (error: {\n      status: number\n      redirect: boolean\n      message: string\n    }) => {\n      // Check if it's a redirect error (TanStack Start throws redirects as errors)\n      if (\n        error?.status === 302 ||\n        error?.redirect ||\n        error?.message?.includes('redirect')\n      ) {\n        // Invalidate router to refresh auth state\n        await router.invalidate()\n        // Navigate to the redirect destination if provided\n        if (search.redirect) {\n          await navigate({ to: search.redirect })\n        }\n        return\n      }\n      console.error('Sign up error:', error)\n      form.setError('root', { message: error.message || 'Failed to sign up' })\n    },\n  })\n\n  return (\n    <AuthCard\n      title=\"Sign up\"\n      description=\"Enter your details to create a new account\"\n    >\n      <AuthForm\n        schema={signUpSchema}\n        defaultValues={{\n          email: '',\n          password: '',\n        }}\n        onSubmit={(data) => signUpMutation.mutate(data)}\n        submitText=\"Sign up\"\n        loadingText=\"Signing up...\"\n        isLoading={signUpMutation.isPending}\n        form={form}\n      >\n        {(form) => (\n          <>\n            <AuthField\n              control={form.control}\n              name=\"email\"\n              label=\"Email\"\n              placeholder=\"john@doe.com\"\n              type=\"email\"\n            />\n\n            <AuthField\n              control={form.control}\n              name=\"password\"\n              label=\"Password\"\n              placeholder=\"Enter your password\"\n              type=\"password\"\n            />\n          </>\n        )}\n      </AuthForm>\n\n      <div className=\"text-center text-sm text-muted-foreground mt-4 space-x-1\">\n        <div className=\"inline-block\">Already have an account? </div>\n        <div className=\"inline-block\">\n          <Link\n            to=\"/sign-in\"\n            search={search.redirect ? { redirect: search.redirect } : undefined}\n            className=\"font-medium text-primary underline-offset-4 hover:underline\"\n          >\n            Sign in\n          </Link>\n        </div>\n      </div>\n    </AuthCard>\n  )\n}\n"],"mappings":";;;;;;;;;;;;AA8BA,IAAMc,eAAeT,EAAEU,OAAO;CAC5BC,OAAOX,EAAEY,QAAQ,CAACD,MAAM,qCAAqC;CAC7DE,UAAUb,EAAEY,QAAQ,CAACE,IAAI,GAAG,yCAAwC;CACrE,CAAC;AAEF,SAASC,aAAa;CACpB,MAAMC,SAASjB,UAAU,EAAEkB,MAAMT,MAAMU,IAAI,CAAC;CAC5C,MAAMC,WAAWtB,aAAa;CAC9B,MAAMuB,SAAStB,WAAW;CAC1B,MAAMuB,SAAShB,YAAYD,SAAS;CACpC,MAAMkB,OAAOhB,QAAQ;EACnBiB,UAAUhB,YAAYE,aAAa;EACnCe,eAAe;GACbb,OAAO;GACPE,UAAU;GACZ;EACD,CAAC;CAEF,MAAMY,iBAAiB9B,YAAY;EACjC+B,YAAY,OAAOC,SAAuC;AACxD,SAAMN,OAAO,EACXM,MAAM;IAAE,GAAGA;IAAME,UAAUb,OAAOa;IAAS,EAC5C,CAAC;;EAEJC,WAAW,YAAY;AAErB,SAAMV,OAAOW,YAAY;AAEzB,OAAIf,OAAOa,SACT,OAAMV,SAAS,EAAEa,IAAIhB,OAAOa,UAAU,CAAC;;EAI3CI,SAAS,OAAOC,UAIV;AAEJ,OACEA,OAAOC,WAAW,OAClBD,OAAOL,YACPK,OAAOE,SAASC,SAAS,WAAW,EACpC;AAEA,UAAMjB,OAAOW,YAAY;AAEzB,QAAIf,OAAOa,SACT,OAAMV,SAAS,EAAEa,IAAIhB,OAAOa,UAAU,CAAC;AAEzC;;AAEFS,WAAQJ,MAAM,kBAAkBA,MAAM;AACtCZ,QAAKiB,SAAS,QAAQ,EAAEH,SAASF,MAAME,WAAW,qBAAqB,CAAC;;EAE3E,CAAC;AAEF,QACE,qBAAC,UAAA;EACC,OAAM;EACN,aAAY;aAEZ,oBAAC,UAAA;GACC,QAAQ3B;GACR,eAAe;IACbE,OAAO;IACPE,UAAU;IACX;GACD,WAAWc,SAASF,eAAee,OAAOb,KAAK;GAC/C,YAAW;GACX,aAAY;GACZ,WAAWF,eAAegB;GACpBnB;cAEJA,WACA,qBAAA,UAAA,EAAA,UAAA,CACE,oBAAC,WAAA;IACC,SAASA,OAAKoB;IACd,MAAK;IACL,OAAM;IACN,aAAY;IACZ,MAAK;KAAO,EAGd,oBAAC,WAAA;IACC,SAASpB,OAAKoB;IACd,MAAK;IACL,OAAM;IACN,aAAY;IACZ,MAAK;KAAU,CAAA,EAAA,CAGpB;IACO,EAEV,qBAAC,OAAA;GAAI,WAAU;cACb,oBAAC,OAAA;IAAI,WAAU;cAAe;KAA8B,EAC5D,oBAAC,OAAA;IAAI,WAAU;cACb,oBAAC,MAAA;KACC,IAAG;KACH,QAAQ1B,OAAOa,WAAW,EAAEA,UAAUb,OAAOa,UAAU,GAAGc,KAAAA;KAC1D,WAAU;eAA6D;MAGnE;KACH,CAAA;IACF,CAAA;GACI"}